print("noise traitor")
}
}
for(i in 1:length(data13)){
if(
for(j in range(1,10,1)){data13$movavg[j]<data13$movavg[j+1]}
){
print("long-time hold")
}else{
print("noise traitor")
}
}
for(i in 1:length(data13)){
if(
for(j in 1:10){data13$movavg[j]<data13$movavg[j+1]}
){
print("long-time hold")
}else{
print("noise traitor")
}
}
max(data13$movavg)
max(data13$movavg)
max(drop.na(data13$movavg))
max(drop_na(data13$movavg))
Max(data13$movavg)
max(data13$movavg)
max(data13$StockPrice)
max(data13$movavg)
min(data13$movavg)
max(as.numeric(data13$movavg))
max(data13$movavg[5:101])
n = 5
data13 <- fileset[[13]] %>%
mutate(., movavg = rollmean(fileset[[13]]$StockPrice, n,
fill = NA, align = "right")) %>%
select(., Trials, StockPrice, movavg)
data13.long <- gather(data13, type, value, StockPrice, movavg)
plot <- ggplot(data13.long, aes(x = Trials, y = value, color = type))+
geom_line()+
geom_point()+
theme_classic()
plot
Max <- max(data13$movavg[n:101])
for(i in 1:length(data13$movavg == Max)){
if(
for(j in 1:10){data13$movavg[j]<data13$movavg[j+1]}
){
print("long-time hold")
}else{
print("noise traitor")
}
}
View(data13)
data13 <- fileset[[13]] %>%
mutate(., movavg = rollmean(fileset[[13]]$StockPrice, n,
fill = NA, align = "right")) %>%
select(., Trials,p1Stock, StockPrice, movavg)
View(data13)
data13.long <- gather(data13, type, value, StockPrice, movavg)
plot <- ggplot(data13.long, aes(x = Trials, y = value, color = type))+
geom_line()+
geom_point()+
theme_classic()
plot
Max <- max(data13$movavg[n:101])
for(i in 1:length(data13$movavg == Max)){
if(
for (j in 1:10) {
data13$p1Stock[j]<data13$p1Stock[j+1]
}
){
print("long-time holder")
}else{
print("noise traitor")
}
}
for(i in 1:length(data13$movavg == Max)){
for (j in 1:10) {
if(
data13$p1Stock[j]<data13$p1Stock[j+1]
){
print("long-time holder")
}else{
print("noise traitor")
}
}
}
n = 5
data13 <- fileset[[13]] %>%
mutate(., movavg = rollmean(fileset[[13]]$StockPrice, n,
fill = NA, align = "right")) %>%
select(., Trials,p1Stock, StockPrice, movavg)
data13.long <- gather(data13, type, value, StockPrice, movavg)
plot <- ggplot(data13.long, aes(x = Trials, y = value, color = type))+
geom_line()+
geom_point()+
theme_classic()
plot
Max <- max(data13$movavg[n:101])
for (j in 1:9) {
if(
data13$p1Stock[j]<data13$p1Stock[j+1]
){
print("long-time holder")
}else{
print("noise traitor")
}
}
data13$p1Stock[j]<data13$p1Stock[j+1]
if(for (j in 1:9) {
data13$p1Stock[j]<data13$p1Stock[j+1]
}){
print("long")
}
data13$p1Stock[j]<data13$p1Stock[j+1]
for (j in 1:9) {
data13$p1Stock[j]<data13$p1Stock[j+1]
})
for (j in 1:9) {
data13$p1Stock[j]<data13$p1Stock[j+1]
}
a = for (j in 1:9) {
data13$p1Stock[j]<data13$p1Stock[j+1]
}
for (j in 1:9) {
data13$p1Stock[j]<data13$p1Stock[j+1]
}
setwd("C:\\Users\\User\\Desktop\\ebg408\\shiny")
filepath = "data"
filenames = list.files(path = filepath, pattern="*.csv")
fileset <- lapply(paste0(filepath,"/",filenames), read.csv)
library(zoo)
n = 5
data13 <- fileset[[13]] %>%
mutate(., movavg = rollmean(fileset[[13]]$StockPrice, n,
fill = NA, align = "right")) %>%
select(., Trials,p1Stock, StockPrice, movavg)
data13.long <- gather(data13, type, value, StockPrice, movavg)
plot <- ggplot(data13.long, aes(x = Trials, y = value, color = type))+
geom_line()+
geom_point()+
theme_classic()
plot
Max <- max(data13$movavg[n:101])
for(i in 1:length(data13$movavg == Max)){
for (j in 1:9) {
if(
data13$p1Stock[j]<data13$p1Stock[j+1]
){
print("long-time holder")
}else{
print("noise traitor")
}
}
}
if(for (j in 1:9) {
data13$p1Stock[j]<data13$p1Stock[j+1]
}){
print("lon")
}
if(
data13$p1Stock[j]<data13$p1Stock[j+1]
){
print("long-time holder")
}else{
print("noise traitor")
}
for (j in 1:9) {
if(
data13$p1Stock[j]<data13$p1Stock[j+1]
){
print("long-time holder")
}else{
print("non")
}
}
data13 <- fileset[[13]] %>%
mutate(., movavg = rollmean(fileset[[13]]$StockPrice, n,
fill = NA, align = "right")) %>%
select(., Trials,action, StockPrice, movavg)
fileset[[13]]
data13 <- fileset[[13]] %>%
mutate(., movavg = rollmean(fileset[[13]]$StockPrice, n,
fill = NA, align = "right")) %>%
select(., Trials,p1Decision, StockPrice, movavg)
data13.long <- gather(data13, type, value, StockPrice, movavg)
plot <- ggplot(data13.long, aes(x = Trials, y = value, color = type))+
geom_line()+
geom_point()+
theme_classic()
plot
Max <- max(data13$movavg[n:101])
data13 <- fileset[[13]] %>%
mutate(., movavg = rollmean(fileset[[13]]$StockPrice, n,
fill = NA, align = "right")) %>%
mutate(., buy = ifelse(fileset[[13]]$p1Decision=="buy",1,0)
, sell = ifelse(fileset[[13]]$p1Decision=="sell",1,0))%>%
select(., Trials, buy, sell, StockPrice, movavg)
View(data13)
data13.long <- gather(data13, type, value, StockPrice, movavg)
plot <- ggplot(data13.long, aes(x = Trials, y = value, color = type))+
geom_line()+
geom_point()+
theme_classic()
plot
Max <- max(data13$movavg[n:101])
for(i in 1:length(data13$movavg == Max)){
if(sum(data13$buy[i:i+10])>=9){
print("long")
}
}
for(i in 1:length(data13$movavg == Max)){
if(sum(data13$buy[i:i+10]) >= 9){
print("long")
}else{
print("non")
}
}
for(i in 1:length(data13$movavg == Max)){
if(sum(data13$buy[i:i+10]) >= 9){
print("long")
}else{
print(i)
}
}
if(data13$movavg[i] = max(data13$movavg[n:101])){
print(i)
}
if(data13$movavg[a] = max(data13$movavg[n:101])){
print(a)
}
setwd("C:\\Users\\User\\Desktop\\ebg408\\shiny")
filepath = "data"
filenames = list.files(path = filepath, pattern="*.csv")
fileset <- lapply(paste0(filepath,"/",filenames), read.csv)
fileset[[13]]
library(zoo)
n = 5
data13 <- fileset[[13]] %>%
mutate(., movavg = rollmean(fileset[[13]]$StockPrice, n,
fill = NA, align = "right")) %>%
mutate(., buy = ifelse(fileset[[13]]$p1Decision=="buy",1,0)
, sell = ifelse(fileset[[13]]$p1Decision=="sell",1,0))%>%
select(., Trials, buy, sell, StockPrice, movavg)
data13.long <- gather(data13, type, value, StockPrice, movavg)
plot <- ggplot(data13.long, aes(x = Trials, y = value, color = type))+
geom_line()+
geom_point()+
theme_classic()
plot
if(data13$movavg[i] = max(data13$movavg[n:101])){
print(i)
}
for (i in 1:length(data13)) {
if(data13$movavg[i] = max(data13$movavg[n:101])){
print(i)
}
}
for (i in 1:length(data13)) {
if(data13$movavg[i] == max(data13$movavg[n:101])){
print(i)
}
}
for (i in 1:nrow(data13)) {
if(data13$movavg[i] == max(data13$movavg[n:101])){
print(i)
}
}
if(data13$movavg[i] == max(data13$movavg[n:101])){
print(i)
}
print("non")
for (i in 1:nrow(data13)) {
if(data13$movavg[i] == max(data13$movavg[n:101])){
print(i)
}else{
print("non")
}
}
for(i in 1:length(data13$movavg == Max)){
if(mean(data13$buy[i:i+10]) >= 9){
print("long")
}else{
print(i)
}
}
for(i in 1:length(data13$movavg == max(data13$movavg[n:101]) )){
if(mean(data13$buy[i:i+10]) >= 9){
print("long")
}else{
print(i)
}
}
data13$buy[1:10]
sum(data13$buy[1:10])
if(sum(data13$buy[i:i+10]) >= 9){
print("long")
}else{
print(i)
}
for(i in 1:length(data13$movavg == max(data13$movavg[n:101]) )){
if(sum(data13$buy[i:i+10]) >= 9){
print("long")
}else{
print(i)
}
}
for(i in 1:length(data13$movavg == max(data13$movavg[n:101]) )){
if(sum(data13$buy[i:i+10]) >= 9){
print("第"+i+"回合")
print("long-holder")
}
}
max(data13$movavg[n:101])
length(data13$movavg == max(data13$movavg[n:101])
length(data13$movavg == max(data13$movavg[n:101]))
n(data13$movavg == max(data13$movavg[n:101]))
nrow(data13$movavg == max(data13$movavg[n:101]))
data13$movavg[i] == max(data13$movavg[n:101]))
data13$movavg[i] == max(data13$movavg[n:101])
data13$movavg[64] == max(data13$movavg[n:101])
for(i in 1:64){
if(sum(data13$buy[i:i+10]) >= 9){
print("第"+i+"回合")
print("long-holder")
}
}
print("noice traitor")
for(i in 1:64){
if(sum(data13$buy[i:i+10]) >= 9){
print("第"+i+"回合")
print("long-holder")
}else{
print("noice traitor")
}
}
for(i in 1:64){
if(sum(data13$buy[i:i+10]) >= 9){
print("第"+i+"回合")
print("long-holder")
}
}
data13$movavg[64] == max(data13$movavg[n:101])
for (i in 1:101) {
if(data13$movavg[i] == max(data13$movavg[n:101])){
max.trial = i
}
}
for(i in 1:as.numeric(max.trial)){
if(sum(data13$buy[i:i+10]) >= 9){
print("第"+i+"回合")
print("long-holder")
}
}
for (i in 1:101) {
if(data13$movavg[i] == max(data13$movavg[n:101])){
print(i)
max.trial = i
}
}
for (i in n:101) {
if(data13$movavg[i] == max(data13$movavg[n:101])){
print(i)
max.trial = i
}
}
for(i in 1:as.numeric(max.trial)){
if(sum(data13$buy[i:i+10]) >= 9){
print("第"+i+"回合")
print("long-holder")
}
}
for(i in as.numeric(max.trial):101){
if(sum(data13$sell[i:i+9]) >= 9){
print("第"+i+"回合")
print("most-profit")
}
}
for(i in as.numeric(max.trial):100){
if(sum(data13$sell[i:i+9]) >= 9){
print("第"+i+"回合")
print("most-profit")
}
}
max.trial
for(i in as.numeric(max.trial):92){
if(sum(data13$sell[i:i+9]) >= 9){
print("第"+i+"回合")
print("most-profit")
}
}
for(i in as.numeric(max.trial):101){
if(sum(data13$sell[i-9:i]) >= 9){
print("第"+i+"回合")
print("most-profit")
}
}
for(i in as.numeric(max.trial):101){
if(sum(data13$sell[i-9:i]) >= 9){
print("第"+i+"回合")
print("most-profit")
}
}
for(i in as.numeric(max.trial):92){
if(sum(data13$sell[i:i=9]) >= 9){
print("第"+i+"回合")
print("most-profit")
}
}
for(i in as.numeric(max.trial):92){
if(sum(data13$sell[i:i=9]) >= 9){
print("第"+i+"回合")
print("most-profit")
}
}
for(i in as.numeric(max.trial):92){
if(sum(data13$sell[i:i+9]) >= 9){
print("第"+i+"回合")
print("most-profit")
}
}
data13 <- fileset[[13]] %>%
mutate(., movavg = rollmean(fileset[[13]]$StockPrice, n,
fill = NA, align = "right")) %>%
mutate(., buy = ifelse(fileset[[13]]$p1Decision=="buy",1,0)
, sell = ifelse(fileset[[13]]$p1Decision=="sell",1,0)
, notrade = ifelse(fileset[[13]]$p1Decision=="no trade",1,0))%>%
select(., Trials, buy, sell, StockPrice, movavg)
data13
data13 <- fileset[[13]] %>%
mutate(., movavg = rollmean(fileset[[13]]$StockPrice, n,
fill = NA, align = "right")) %>%
mutate(., buy = ifelse(fileset[[13]]$p1Decision=="buy",1,0)
, sell = ifelse(fileset[[13]]$p1Decision=="sell",1,0)
, notrade = ifelse(fileset[[13]]$p1Decision=="no trade",1,0))%>%
select(., Trials, buy, sell, notrade, StockPrice, movavg)
data13.long <- gather(data13, type, value, StockPrice, movavg)
View(data13.long)
data13.long <- gather(data13, price_type, price, StockPrice, movavg)
plot <- ggplot(data13.long, aes(x = Trials, y = value, color = type))+
geom_line()+
geom_point()+
theme_classic()
plot <- ggplot(data13.long, aes(x = Trials, y = price, color = type))+
geom_line()+
geom_point()+
theme_classic()
plot
plot <- ggplot(data13.long, aes(x = Trials, y = price, color = price_type))+
geom_line()+
geom_point()+
theme_classic()
plot
for (i in n:101) {
if(data13$movavg[i] == max(data13$movavg[n:101])){
print(i)
max.trial = i
}
}
for(i in 1:as.numeric(max.trial)){
if(sum(data13$buy[i:i+9]) >= 9){
print("第"+i+"回合")
print("long-holder")
}
}
for(i in as.numeric(max.trial):92){
if(sum(data13$sell[i:i+9]) >= 9){
print("第"+i+"回合")
print("most-profit")
}
}
setwd("C:\\Users\\User\\Desktop\\ebg408\\shiny")
filepath = "data"
setwd("C:\\Users\\User\\Desktop\\ebg408\\shiny")
filepath = "data"
filenames = list.files(path = filepath, pattern="*.csv")
fileset <- lapply(paste0(filepath,"/",filenames), read.csv)
fileset[[13]]
library(zoo)
n = 5
data <- fileset[[13]] %>%
mutate(., movavg = rollmean(fileset[[13]]$StockPrice, n,
fill = NA, align = "right")) %>%
mutate(., buy = ifelse(fileset[[13]]$p1Decision=="buy",1,0)
, sell = ifelse(fileset[[13]]$p1Decision=="sell",1,0)
, notrade = ifelse(fileset[[13]]$p1Decision=="no trade",1,0))%>%
select(., Trials, buy, sell, notrade, StockPrice, movavg)
data.long <- gather(data, price_type, price, StockPrice, movavg)
plot <- ggplot(data.long, aes(x = Trials, y = price, color = price_type))+
geom_line()+
geom_point()+
theme_classic()
plot
for (i in n:101) {
if(data$movavg[i] == max(data$movavg[n:101])){
print(i)
max.trial = i
}
}
for(i in 1:as.numeric(max.trial)){
if(sum(data$buy[i:i+9]) >= 9){
print("第"+i+"回合")
print("long-holder")
}
}
for(i in as.numeric(max.trial):92){
if(sum(data$sell[i:i+9]) >= 9){
print("第"+i+"回合")
print("most-profit")
}
}
